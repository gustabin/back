package ar.com.santanderrio.obp.servicios.descuento.cheques.bo;

import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.Matchers;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.Spy;
import org.mockito.runners.MockitoJUnitRunner;

import com.google.gson.Gson;

import ar.com.santanderrio.obp.base.dao.DAOException;
import ar.com.santanderrio.obp.base.mensaje.entities.Mensaje;
import ar.com.santanderrio.obp.base.respuesta.entities.EstadoRespuesta;
import ar.com.santanderrio.obp.base.respuesta.entities.Respuesta;
import ar.com.santanderrio.obp.servicios.clientes.entities.Cliente;
import ar.com.santanderrio.obp.servicios.comun.legal.bo.LegalBO;
import ar.com.santanderrio.obp.servicios.comun.mensaje.bo.MensajeBO;
import ar.com.santanderrio.obp.servicios.cuentas.entities.Cuenta;
import ar.com.santanderrio.obp.servicios.descuento.cheques.bo.impl.AltaChequesBOImpl;
import ar.com.santanderrio.obp.servicios.descuento.cheques.dao.CodigosBancariosDAO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.dao.EfectuarAltaChequesDAO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.dao.EntidadesDAO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.dao.SimulacionAltaChequeDAO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.entities.ChequesASimularDTO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.entities.ChequesAltaDTO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.entities.ChequesSimuladosDTO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.entities.DatosCesionDTO;
import ar.com.santanderrio.obp.servicios.descuento.cheques.entities.EfectivizacionAltaChequesEntity;
import ar.com.santanderrio.obp.servicios.descuento.cheques.entities.SimulacionAltaChequesEntity;
import ar.com.santanderrio.obp.servicios.descuento.cheques.web.view.AltaChequesViewIn;
import ar.com.santanderrio.obp.servicios.factory.RespuestaFactory;

@RunWith(MockitoJUnitRunner.class)
public class SimulacionAltaChequesBOTest {

	@InjectMocks
	AltaChequesBO simulacionBO = new AltaChequesBOImpl();
	
	@Mock
	private SimulacionAltaChequeDAO simulador;
	
	@Mock
	private EfectuarAltaChequesDAO efectivizacion;

	
	@Mock
	private CodigosBancariosDAO codigosDAO;

	@Mock
	private EntidadesDAO entidadesDAO;
	
	@Mock
	private MensajeBO mensajeBO;
	
	@Mock
	private LegalBO legalBO;
	
	@Spy
	@InjectMocks
	private RespuestaFactory respuestaFactory = new RespuestaFactory();

	@Test
	public void simularAltaChequesOKTest() throws DAOException {
		Gson gson = new Gson();
		SimulacionAltaChequesEntity entity = gson.fromJson("{\"headerTrama\":\"200000000000P04HTML0009900010303GSME08  ********00475562000000102017122712331400000000IBF00LYX000000000000ACTPRECAR_1000000            03682408    00        00 012328003201712271233100000000000                            0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000DH\",\"codigoRetornoExtendido\":\"00000000\",\"tipoCuenta\":\"09\",\"sucCuenta\":\"0000\",\"nroCuenta\":\"3604292\",\"nroTramite\":\"0000130217\",\"disponible\":\"000000000543277\",\"tasaAplicada\":\"0000000000\",\"tasaTem\":\"0000000000\",\"tasaCft\":\"0000000000\",\"marcaGarantia\":\"N\",\"marcaAfip\":\"N\",\"marcaClteVinc\":\"S\",\"marcaBcra\":\"N\",\"marcaProducto\":\"N\",\"marcaTasa\":\"N\",\"cantChqAcep\":\"10\",\"cantChqRech\":\"00\",\"sumImpuChqAcep\":\"000000000050000\",\"sumComChqAcep\":\"000000000000000\",\"sumIntChqAcep\":\"000000000000000\",\"sumCfChqAcep\":\"000000000000000\",\"sumImpuesChqAcep\":\"000000000000000\",\"impNetoChqAcep\":\"000000000050000\",\"comisionAdic\":\"000000000005000\",\"impTotalAcred\":\"000000000045000\",\"impTotalChqRech\":\"000000000000000\",\"estTramite\":\"02\",\"descEstTramite\":\"ACEPTADA                                          \",\"fechaRecalculo\":\"          \",\"motRechCliente\":\"                                                                                                    \",\"estTramiteDet\":\"03\",\"descEstTramiteDet\":\"ACEPTADO                                          \",\"MotRechCliAmig\":\"                                                                                                    \",\"cantidadRegistros\":10,\"operaciones\":[{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"00001613\",\"digVerif2\":\"9\",\"ctaGirada\":\"00000230670\",\"digVerif3\":\"0\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385825\",\"digVerif2\":\"2\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385828\",\"digVerif2\":\"3\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385849\",\"digVerif2\":\"8\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385865\",\"digVerif2\":\"8\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061298\",\"digVerif2\":\"7\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061303\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061316\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061317\",\"digVerif2\":\"1\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061321\",\"digVerif2\":\"8\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"fecVtoChq\":\"2018-01-03\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"}]}", SimulacionAltaChequesEntity.class);
		entity.setTasaCft("0000001000");
		AltaChequesViewIn altaCheque = gson.fromJson("{\"listaCheques\":[{\"datosCheque\":{\"inputBanco\":\"072\",\"inputSucursal\":\"280\",\"inputCP\":\"1642\",\"inputVerificador1\":\"8\",\"inputCheque\":\"81061303\",\"inputVerificador2\":\"4\",\"inputCuenta\":\"00003205631\",\"inputVerificador3\":\"4\"},\"nroCheque\":\"07228016428810613034000032056314\",\"valor\":120,\"dni\":\"20378668817\",\"tipo\":\"CUIT\",\"fechaPago\":\"31/05/2018\"}]}", AltaChequesViewIn.class);
		Mockito.when(simulador.simularAltaChequesDAO(Matchers.any(ChequesASimularDTO.class), Matchers.any(Cliente.class))).thenReturn(entity );
		Mockito.when(codigosDAO.obtenerIndiceCodigoBancario(Matchers.anyString())).thenReturn(2);
		Mockito.when(entidadesDAO.obtenerIndiceCodigoBancario(2)).thenReturn("SANTANDER");
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("0000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesSimuladosDTO> res = simulacionBO.simularAltaCheques(new Cliente(), "", new DatosCesionDTO(),
				cuenta, altaCheque);
		Assert.assertTrue(EstadoRespuesta.OK.equals(res.getEstadoRespuesta()));
	}
	
	@Test
	public void simularAltaChequesRechazadaTest() throws DAOException {
		Gson gson = new Gson();
		SimulacionAltaChequesEntity entity = gson.fromJson("{\"headerTrama\":\"200000000000P04HTML0009900010303GSME08  ********00460878000000082018032311041400000000IBF006RJ000000000000ACTPRECAR_1000000            03682408    00        00 011018590201803231104070000000000                            0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000DH\",\"codigoRetornoExtendido\":\"00000000\",\"tipoCuenta\":\"09\",\"sucCuenta\":\"0000\",\"nroCuenta\":\"3604292\",\"nroTramite\":\"0000130241\",\"disponible\":\"000000035991490\",\"tasaAplicada\":\"0000295000\",\"tasaTem\":\"0000348350\",\"tasaCft\":\"0000437214\",\"marcaGarantia\":\"N\",\"marcaAfip\":\"N\",\"marcaClteVinc\":\"S\",\"marcaBcra\":\"N\",\"marcaProducto\":\"N\",\"marcaTasa\":\"N\",\"cantChqAcep\":\"01\",\"cantChqRech\":\"03\",\"sumImpuChqAcep\":\"000000000010000\",\"sumComChqAcep\":\"000000000000000\",\"sumIntChqAcep\":\"000000000000259\",\"sumCfChqAcep\":\"000000000000000\",\"sumImpuesChqAcep\":\"000000000000065\",\"impNetoChqAcep\":\"000000000009676\",\"comisionAdic\":\"000000000005000\",\"impTotalAcred\":\"000000000004676\",\"impTotalChqRech\":\"000000000030000\",\"estTramite\":\"19\",\"descEstTramite\":\"RECHAZADA SIMULACION                              \",\"fechaRecalculo\":\"          \",\"motRechCliente\":\"LA OPERACION ES MENOR AL MONTO MINIMO ADMITIDO                                                      \",\"estTramiteDet\":\"36\",\"descEstTramiteDet\":\"RECHAZADO OPER. \\u003c MONTO MINIMO ADMITIDO SIMULACION\",\"MotRechCliAmig\":\"POR FAVOR CONTACTESE CON SU EJECUTIVO DE CUENTA, DISCULPE LAS MOLESTIAS OCASIONADAS.                \",\"cantidadRegistros\":4,\"operaciones\":[{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"07093859\",\"digVerif2\":\"9\",\"ctaGirada\":\"90000244017\",\"digVerif3\":\"5\",\"diasAdelantar\":\"000\",\"impCheque\":\"000000000010000\",\"fecVtoChq\":\"2018-04-05\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000010000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00021767058\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"2\",\"mensRechCliente\":\"POR EL MOMENTO EL CHEQUE NO ES ACEPTADO PARA SER APLICADO A LA OPERACION                            \",\"mensajeRechTecnico\":\"EL CHQ EXISTE EN CARTERA DE CESION Y NO ES REDEPO   SITABLE                                         \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"9999\",\"digVerif1\":\"1\",\"nroCheque\":\"00000324\",\"digVerif2\":\"5\",\"ctaGirada\":\"00000232645\",\"digVerif3\":\"0\",\"diasAdelantar\":\"000\",\"impCheque\":\"000000000010000\",\"fecVtoChq\":\"2018-04-16\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000010000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00013238861\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"2\",\"mensRechCliente\":\"POR EL MOMENTO EL CHEQUE NO ES ACEPTADO PARA SER APLICADO A LA OPERACION                            \",\"mensajeRechTecnico\":\"90 - ZQ9CCCO0             - (ZY8COPE0/60        O   SITABLE                                         \"},{\"porcInteresAdel\":\"0000025900\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061301\",\"digVerif2\":\"0\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"000\",\"impCheque\":\"000000000010000\",\"fecVtoChq\":\"2018-04-24\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000259\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000065\",\"impNeto\":\"000000000009676\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00005134021\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"1202457877\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061303\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"000\",\"impCheque\":\"000000000010000\",\"fecVtoChq\":\"2018-04-18\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000210\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000053\",\"impNeto\":\"000000000009737\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00022792232\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"2\",\"mensRechCliente\":\"POR EL MOMENTO EL CHEQUE NO ES ACEPTADO PARA SER APLICADO A LA OPERACION                            \",\"mensajeRechTecnico\":\"EL CLIENTE ES EL LIBRADOR DEL CHEQUE\"}]}", SimulacionAltaChequesEntity.class);
		Mockito.when(simulador.simularAltaChequesDAO(Matchers.any(ChequesASimularDTO.class), Matchers.any(Cliente.class))).thenReturn(entity );
		Mockito.when(codigosDAO.obtenerIndiceCodigoBancario(Matchers.anyString())).thenReturn(2);
		Mockito.when(entidadesDAO.obtenerIndiceCodigoBancario(2)).thenReturn("SANTANDER");
		Mockito.when(mensajeBO.obtenerMensajePorCodigo(Matchers.anyString())).thenReturn(new Mensaje());
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("0000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesSimuladosDTO> res = simulacionBO.simularAltaCheques(new Cliente(), "", new DatosCesionDTO(),
				cuenta, new AltaChequesViewIn());
		Assert.assertTrue(EstadoRespuesta.ERROR.equals(res.getEstadoRespuesta()));
	}
	
	@Test
	public void simularAltaChequesErrorGenericoTest() throws DAOException {
		Mockito.when(simulador.simularAltaChequesDAO(Matchers.any(ChequesASimularDTO.class), Matchers.any(Cliente.class))).thenThrow(new DAOException());
		Mockito.when(mensajeBO.obtenerMensajePorCodigo(Matchers.anyString())).thenReturn(new Mensaje());
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("0000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesSimuladosDTO> res = simulacionBO.simularAltaCheques(new Cliente(), "", new DatosCesionDTO(),
				cuenta, new AltaChequesViewIn());
		Assert.assertTrue(EstadoRespuesta.ERROR.equals(res.getEstadoRespuesta()));
	}
	
	@Test
	public void simularAltaChequesErrorFueraHorarioTest() throws DAOException {
		Gson gson = new Gson();
		SimulacionAltaChequesEntity entity = gson.fromJson("{\"codigoRetornoExtendido\":\"10000083\",\"operaciones\":[]}", SimulacionAltaChequesEntity.class);
		Mockito.when(simulador.simularAltaChequesDAO(Matchers.any(ChequesASimularDTO.class), Matchers.any(Cliente.class))).thenReturn(entity );
		Mockito.when(codigosDAO.obtenerIndiceCodigoBancario(Matchers.anyString())).thenReturn(2);
		Mockito.when(entidadesDAO.obtenerIndiceCodigoBancario(2)).thenReturn("SANTANDER");
		Mockito.when(mensajeBO.obtenerMensajePorCodigo(Matchers.anyString())).thenReturn(new Mensaje());
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("00000000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesSimuladosDTO> res = simulacionBO.simularAltaCheques(new Cliente(), "", new DatosCesionDTO(),
				cuenta, new AltaChequesViewIn());
		Assert.assertTrue(EstadoRespuesta.ERROR.equals(res.getEstadoRespuesta()));
	}
	
	@Test
	public void simularAltaChequesConAlgunosRechazadosErrorTest() throws DAOException {
		Gson gson = new Gson();
		SimulacionAltaChequesEntity entity = gson.fromJson("{\"headerTrama\":\"200000000000P04HTML0009900010303GSME08  ********00543400000000082017121417110500000000IBF00SOQ000000000000ACTPRECAR_1000000            03682408    00        00 017198035201712141711020000000000                            0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000DH\",\"codigoRetornoExtendido\":\"00000000\",\"tipoCuenta\":\"09\",\"sucCuenta\":\"0000\",\"nroCuenta\":\"3604292\",\"nroTramite\":\"0000130211\",\"disponible\":\"000000000591277\",\"tasaAplicada\":\"0000000000\",\"tasaTem\":\"0000000000\",\"tasaCft\":\"0000000000\",\"marcaGarantia\":\"N\",\"marcaAfip\":\"N\",\"marcaClteVinc\":\"S\",\"marcaBcra\":\"N\",\"marcaProducto\":\"N\",\"marcaTasa\":\"N\",\"cantChqAcep\":\"02\",\"cantChqRech\":\"02\",\"sumImpuChqAcep\":\"000000000002000\",\"sumComChqAcep\":\"000000000000000\",\"sumIntChqAcep\":\"000000000000000\",\"sumCfChqAcep\":\"000000000000000\",\"sumImpuesChqAcep\":\"000000000000000\",\"impNetoChqAcep\":\"000000000002000\",\"comisionAdic\":\"000000000000000\",\"impTotalAcred\":\"000000000002000\",\"impTotalChqRech\":\"000000000400600\",\"estTramite\":\"02\",\"descEstTramite\":\"ACEPTADA                                          \",\"fechaRecalculo\":\"          \",\"motRechCliente\":\"                                                                                                    \",\"estTramiteDet\":\"03\",\"descEstTramiteDet\":\"ACEPTADO                                          \",\"MotRechCliAmig\":\"                                                                                                    \",\"cantidadRegistros\":4,\"operaciones\":[{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"015\",\"sucGirada\":\"112\",\"codPostal\":\"1059\",\"digVerif1\":\"7\",\"nroCheque\":\"49069253\",\"digVerif2\":\"4\",\"ctaGirada\":\"24300148244\",\"digVerif3\":\"8\",\"diasAdelantar\":\"012\",\"impCheque\":\"000000000001000\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000001000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00021767058\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1000\",\"digVerif1\":\"2\",\"nroCheque\":\"51100044\",\"digVerif2\":\"1\",\"ctaGirada\":\"00003616534\",\"digVerif3\":\"6\",\"diasAdelantar\":\"008\",\"impCheque\":\"000000000001000\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000001000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00013238861\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061298\",\"digVerif2\":\"7\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"008\",\"impCheque\":\"000000000300300\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000300300\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00023333444\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"2\",\"mensRechCliente\":\"POR EL MOMENTO EL CHEQUE NO ES ACEPTADO PARA SER APLICADO A LA OPERACION                            \",\"mensajeRechTecnico\":\"N00023333444 SUPERA EL 30% DEL MONTO DE CESION                                                      \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061303\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"008\",\"impCheque\":\"000000000100300\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000100300\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00023333444\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"2\",\"mensRechCliente\":\"POR EL MOMENTO EL CHEQUE NO ES ACEPTADO PARA SER APLICADO A LA OPERACION                            \",\"mensajeRechTecnico\":\"N00023333444 SUPERA EL 30% DEL MONTO DE CESION                                                      \"}]}", SimulacionAltaChequesEntity.class);
		Mockito.when(simulador.simularAltaChequesDAO(Matchers.any(ChequesASimularDTO.class), Matchers.any(Cliente.class))).thenReturn(entity );
		Mockito.when(codigosDAO.obtenerIndiceCodigoBancario(Matchers.anyString())).thenReturn(2);
		Mockito.when(entidadesDAO.obtenerIndiceCodigoBancario(2)).thenReturn("SANTANDER");
		Mockito.when(mensajeBO.obtenerMensajePorCodigo(Matchers.anyString())).thenReturn(new Mensaje());
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("0000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesSimuladosDTO> res = simulacionBO.simularAltaCheques(new Cliente(), "", new DatosCesionDTO(),
				cuenta, new AltaChequesViewIn());
		Assert.assertTrue(EstadoRespuesta.WARNING.equals(res.getEstadoRespuesta()));
	}
	
	@Test
	public void simularAltaChequesConTodosRechazadosErrorTest() throws DAOException {
		Gson gson = new Gson();
		SimulacionAltaChequesEntity entity = gson.fromJson("{\"headerTrama\":\"200000000000P04HTML0009900010303GSME08  ********00543400000000082017121417110500000000IBF00SOQ000000000000ACTPRECAR_1000000            03682408    00        00 017198035201712141711020000000000                            0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000DH\",\"codigoRetornoExtendido\":\"00000000\",\"tipoCuenta\":\"09\",\"sucCuenta\":\"0000\",\"nroCuenta\":\"3604292\",\"nroTramite\":\"0000130211\",\"disponible\":\"000000000591277\",\"tasaAplicada\":\"0000000000\",\"tasaTem\":\"0000000000\",\"tasaCft\":\"0000000000\",\"marcaGarantia\":\"N\",\"marcaAfip\":\"N\",\"marcaClteVinc\":\"S\",\"marcaBcra\":\"N\",\"marcaProducto\":\"N\",\"marcaTasa\":\"N\",\"cantChqAcep\":\"02\",\"cantChqRech\":\"02\",\"sumImpuChqAcep\":\"000000000002000\",\"sumComChqAcep\":\"000000000000000\",\"sumIntChqAcep\":\"000000000000000\",\"sumCfChqAcep\":\"000000000000000\",\"sumImpuesChqAcep\":\"000000000000000\",\"impNetoChqAcep\":\"000000000002000\",\"comisionAdic\":\"000000000000000\",\"impTotalAcred\":\"000000000002000\",\"impTotalChqRech\":\"000000000400600\",\"estTramite\":\"02\",\"descEstTramite\":\"ACEPTADA                                          \",\"fechaRecalculo\":\"          \",\"motRechCliente\":\"                                                                                                    \",\"estTramiteDet\":\"03\",\"descEstTramiteDet\":\"ACEPTADO                                          \",\"MotRechCliAmig\":\"                                                                                                    \",\"cantidadRegistros\":4,\"operaciones\":[{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"015\",\"sucGirada\":\"112\",\"codPostal\":\"1059\",\"digVerif1\":\"7\",\"nroCheque\":\"49069253\",\"digVerif2\":\"4\",\"ctaGirada\":\"24300148244\",\"digVerif3\":\"8\",\"diasAdelantar\":\"012\",\"impCheque\":\"000000000001000\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000001000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00021767058\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1000\",\"digVerif1\":\"2\",\"nroCheque\":\"51100044\",\"digVerif2\":\"1\",\"ctaGirada\":\"00003616534\",\"digVerif3\":\"6\",\"diasAdelantar\":\"008\",\"impCheque\":\"000000000001000\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000001000\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00013238861\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"1\",\"mensRechCliente\":\"                                                                                                    \",\"mensajeRechTecnico\":\"                                                                                                    \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061298\",\"digVerif2\":\"7\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"008\",\"impCheque\":\"000000000300300\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000300300\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00023333444\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"2\",\"mensRechCliente\":\"POR EL MOMENTO EL CHEQUE NO ES ACEPTADO PARA SER APLICADO A LA OPERACION                            \",\"mensajeRechTecnico\":\"N00023333444 SUPERA EL 30% DEL MONTO DE CESION                                                      \"},{\"porcInteresAdel\":\"0000000000\",\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061303\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"diasAdelantar\":\"008\",\"impCheque\":\"000000000100300\",\"fecVtoChq\":\"2017-12-22\",\"impComision\":\"000000000000000\",\"impInteres\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000100300\",\"tpoDocLibr1\":\"N\",\"nroDocLibr1\":\"00023333444\",\"tpoDocLibr2\":\" \",\"nroDocLibr2\":\"           \",\"estChq\":\"2\",\"mensRechCliente\":\"POR EL MOMENTO EL CHEQUE NO ES ACEPTADO PARA SER APLICADO A LA OPERACION                            \",\"mensajeRechTecnico\":\"N00023333444 SUPERA EL 30% DEL MONTO DE CESION                                                      \"}]}", SimulacionAltaChequesEntity.class);
		entity.setEstTramite("4");
		Mockito.when(simulador.simularAltaChequesDAO(Matchers.any(ChequesASimularDTO.class), Matchers.any(Cliente.class))).thenReturn(entity );
		Mockito.when(codigosDAO.obtenerIndiceCodigoBancario(Matchers.anyString())).thenReturn(2);
		Mockito.when(entidadesDAO.obtenerIndiceCodigoBancario(2)).thenReturn("SANTANDER");
		Mockito.when(mensajeBO.obtenerMensajePorCodigo(Matchers.anyString())).thenReturn(new Mensaje());
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("0000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesSimuladosDTO> res = simulacionBO.simularAltaCheques(new Cliente(), "", new DatosCesionDTO(),
				cuenta, new AltaChequesViewIn());
		Assert.assertTrue(EstadoRespuesta.WARNING.equals(res.getEstadoRespuesta()));
	}
	
	@Test
	public void efectuarAltaChequesOKTest() throws DAOException {
		Gson gson = new Gson();
		EfectivizacionAltaChequesEntity entity = gson.fromJson("{\"headerTrama\":\"200000000000P04HTML0009900010303GSME08  ********00475562000000112017122712333300000000IBF00LZ9000000000000ACTCONFPRE1000000            03682408    00        00 012328034201712271233190000000000                            0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000DH\",\"codigoRetornoExtendido\":\"00000000\",\"tipoCuentaCredito\":\"00\",\"sucCuentaCredito\":\"000\",\"nroCuentaCredito\":\"3604292\",\"codEstTramiteFinal\":\"03\",\"desEstTramiteFinal\":\"PRECARGA                                          \",\"marcaGarantia\":\"N\",\"marcaAfip\":\"N\",\"marcaClteVinc\":\"S\",\"marcaBCRA\":\"N\",\"marcaProducto\":\"N\",\"marcaTasa\":\"N\",\"fechaAlta\":\"2017-12-27\",\"divisa\":\"ARS\",\"tasaAplic\":\"0000000000\",\"tasaTEA\":\"0000000000\",\"tasaCFT\":\"0000000000\",\"cantChqAcep\":\"10\",\"sumImpChqAcep\":\"000000000050000\",\"sumComChqAcep\":\"000000000000000\",\"sumIntChqAcep\":\"000000000000000\",\"sumCfChqAcep\":\"000000000000000\",\"sumImpuChqAcep\":\"000000000000000\",\"impNetoChqAcep\":\"000000000050000\",\"comisionAdic\":\"000000000005000\",\"impTotalAcred\":\"000000000045000\",\"cantidadRegistros\":10,\"operaciones\":[{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"00001613\",\"digVerif2\":\"9\",\"ctaGirada\":\"00000230670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385825\",\"digVerif2\":\"2\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385828\",\"digVerif2\":\"3\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385849\",\"digVerif2\":\"8\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385865\",\"digVerif2\":\"8\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061298\",\"digVerif2\":\"7\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061303\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061316\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061317\",\"digVerif2\":\"1\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061321\",\"digVerif2\":\"8\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"}]}", EfectivizacionAltaChequesEntity.class);
		Mockito.when(efectivizacion.efectuarAltaChequesDAO(Matchers.anyString(), Matchers.any(Cliente.class))).thenReturn(entity  );
		Mockito.when(codigosDAO.obtenerIndiceCodigoBancario(Matchers.anyString())).thenReturn(2);
		Mockito.when(entidadesDAO.obtenerIndiceCodigoBancario(2)).thenReturn("SANTANDER");
		Mockito.when(mensajeBO.obtenerMensajePorCodigo(Matchers.anyString())).thenReturn(new Mensaje());
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("0000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesAltaDTO> res = simulacionBO.efectuarAltaCheques(new Cliente(), "000218564", "000-060162/3");
		Assert.assertTrue(EstadoRespuesta.OK.equals(res.getEstadoRespuesta()));
	}
	
	@Test
	public void efectuarAltaChequesErrorTest() throws DAOException {
		Gson gson = new Gson();
		SimulacionAltaChequesEntity entity = gson.fromJson("{\"headerTrama\":\"200000000000P04HTML0009900010303GSME08  ********00475562000000112017122712333300000000IBF00LZ9000000000000ACTCONFPRE1000000            03682408    00        00 012328034201712271233190000000000                            0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000DH\",\"codigoRetornoExtendido\":\"00000000\",\"tipoCuentaCredito\":\"00\",\"sucCuentaCredito\":\"000\",\"nroCuentaCredito\":\"3604292\",\"codEstTramiteFinal\":\"03\",\"desEstTramiteFinal\":\"PRECARGA                                          \",\"marcaGarantia\":\"N\",\"marcaAfip\":\"N\",\"marcaClteVinc\":\"S\",\"marcaBCRA\":\"N\",\"marcaProducto\":\"N\",\"marcaTasa\":\"N\",\"fechaAlta\":\"2017-12-27\",\"divisa\":\"ARS\",\"tasaAplic\":\"0000000000\",\"tasaTEA\":\"0000000000\",\"tasaCFT\":\"0000000000\",\"cantChqAcep\":\"10\",\"sumImpChqAcep\":\"000000000050000\",\"sumComChqAcep\":\"000000000000000\",\"sumIntChqAcep\":\"000000000000000\",\"sumCfChqAcep\":\"000000000000000\",\"sumImpuChqAcep\":\"000000000000000\",\"impNetoChqAcep\":\"000000000050000\",\"comisionAdic\":\"000000000005000\",\"impTotalAcred\":\"000000000045000\",\"cantidadRegistros\":10,\"operaciones\":[{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"00001613\",\"digVerif2\":\"9\",\"ctaGirada\":\"00000230670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385825\",\"digVerif2\":\"2\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385828\",\"digVerif2\":\"3\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385849\",\"digVerif2\":\"8\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"000\",\"codPostal\":\"1036\",\"digVerif1\":\"1\",\"nroCheque\":\"96385865\",\"digVerif2\":\"8\",\"ctaGirada\":\"00000171670\",\"digVerif3\":\"0\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061298\",\"digVerif2\":\"7\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061303\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061316\",\"digVerif2\":\"4\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061317\",\"digVerif2\":\"1\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"},{\"bcoGirado\":\"072\",\"sucGirada\":\"280\",\"codPostal\":\"1642\",\"digVerif1\":\"8\",\"nroCheque\":\"81061321\",\"digVerif2\":\"8\",\"ctaGirada\":\"00003205631\",\"digVerif3\":\"4\",\"fechaPresentacion\":\"2018-01-03\",\"diasAdelantar\":\"007\",\"impCheque\":\"000000000005000\",\"impComision\":\"000000000000000\",\"impIntereses\":\"000000000000000\",\"impCFijo\":\"000000000000000\",\"impImpuesto\":\"000000000000000\",\"impNeto\":\"000000000005000\",\"porcInteresesAdel\":\"0000000000\",\"estCheque\":\"1\"}]}", SimulacionAltaChequesEntity.class);
		entity.setCodigoRetornoExtendido("0000001010");
		Mockito.when(simulador.simularAltaChequesDAO(Matchers.any(ChequesASimularDTO.class), Matchers.any(Cliente.class))).thenReturn(entity );
		Mockito.when(codigosDAO.obtenerIndiceCodigoBancario(Matchers.anyString())).thenReturn(2);
		Mockito.when(entidadesDAO.obtenerIndiceCodigoBancario(2)).thenReturn("SANTANDER");
		Mockito.when(mensajeBO.obtenerMensajePorCodigo(Matchers.anyString())).thenReturn(new Mensaje());
		Cuenta cuenta = new Cuenta();
		cuenta.setNroCuentaProducto("0000546487");
		cuenta.setNroSucursal("012");
		cuenta.setTipoCuenta("09");
		Respuesta<ChequesAltaDTO> res = simulacionBO.efectuarAltaCheques(new Cliente(), "000218564", "000-060162/3");
		res.getItemsMensajeRespuesta().get(0).setMensaje("mensaje error");
		Assert.assertTrue(EstadoRespuesta.ERROR.equals(res.getEstadoRespuesta()));
	}
}
